---
title: "Import data"
output: html_notebook
---

<!-- This file by Martin Monkman is licensed under a Creative Commons Attribution 4.0 International License. 
Some of it comes straight from Hadley Wickham & Garrett Grolemund's book _R for Data Science_, found online here: https://r4ds.had.co.nz/
It uses great swaths of content from the tidyverse reference material for {readr} and {readxl}, by RStudio. 
You can find that material here: 
https://readr.tidyverse.org/index.html 
https://readxl.tidyverse.org/index.html
-->


# Getting started

Run this code chunk:

```{r}
library(tidyverse)  # we will be using the functions of {readr}
library(readxl)
```



# 1. Reading a CSV file

CSV files are very commonly used for storing flat files. They don't have any formatting--just the number or text in the cell.

The package {readr} is designed to make importing these files simple.


(This example comes straight from https://readr.tidyverse.org/index.html)

Run this chunk to create an object called `mtcars`, from a CSV file of the same name.

```{r}
# example
mtcars <- read_csv(readr_example("mtcars.csv"))

```

Adding the `cols()` allows us to alter what {readr} has decided for us. For example, we could set the `cyl` variable to be an integer.

```{r}
# example
mtcars <- read_csv(readr_example("mtcars.csv"), col_types = 
                     cols(cyl = col_integer())
                   )

```


## Your Turn 1.1

Insert an R chunk and rerun the example above, but with the `am` and `gear` variables also set to integer.





STOP HERE ...


# 2. Reading an Excel file

If anything, Excel files are more common than CSV and other plain-text data files. They seem to multiply like coat hangers in the closet...

And as we say in the article by Karl Broman & Kara Woo, ["Data Organization in Spreadsheets"](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989), they can encourage some ways of storing information that makes it hard for us to analyze. Excel files can also contain a wide variety of data format types. {readxl} tries to figure out what's going on, but like {readr}, it allows you to override some of those automatic decisions.


```{r}
deaths <- read_excel(readxl_example("deaths.xlsx"))
deaths
```

What do you notice about the "Date of birth" and "Date of death" columns?


## Your Turn 2.2

Read in the "deaths" file, but use the `range = ` option to specify when to start reading the file:

Note that in this example, {readxl} is smart enough to know that the 

```{r}
# Example
deaths <- read_excel(readxl_example("deaths.xlsx"), 
                     range = "A1:B3")

deaths

# solution
deaths <- read_excel(
    readxl_example("deaths.xlsx"),
    range = "A5:F15"
  )

deaths

```

```{r}

# solution
deaths <- read_excel(
    readxl_example("deaths.xlsx"),
    skip = 4,
    n_max = 10
  )

deaths


```



## REFERENCE MATERIAL

You can find more details in _R for Data Science_:
https://r4ds.had.co.nz/data-import.html


{readr} 
https://readr.tidyverse.org/

{readxl}
https://readxl.tidyverse.org/index.html


