---
title: "Tidy data"
subtitle: "with {tidyr}"
author: "BIDA302 - lesson 2"
date: "2019/11/09"
output:
  xaringan::moon_reader:
    css: ["default", "css_files/eigengrau.css", "css_files/eigengrau-fonts.css"]    
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false

# Martin Monkman
---


```{r setup, include=FALSE}

options(htmltools.dir.version = FALSE)

library(tidyverse)

```

class: inverse

# Tidy data

> “Happy families are all alike; every unhappy family is unhappy in its own way.” –– Leo Tolstoy

>“Tidy datasets are all alike, but every messy dataset is messy in its own way.” –– Hadley Wickham



---

# Principles of tidy data

### 1. Each variable must have its own column.

### 2. Each observation must have its own row.

### 3. Each value must have its own cell.




--


![tidy principles](../img/tidy-1.png)

???

From [_R for Data Science_, "Tidy Data"](https://r4ds.had.co.nz/tidy-data.html)


---

# Untidy data: example

```{r}
#tidyr::relig_income
print(tidyr::relig_income, n=5)

```

--

It's untidy because it violates Principle #1: the income variable is spread across 10 columns

???

from {tidyr}; see https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html 


---

To make it tidy, we need to pivot it into a longer form:

```{r}
tidyr::relig_income %>%
  pivot_longer(-religion, names_to = "income_cat", values_to = "count")
```



---
## Is this data tidy?

```{r echo=FALSE}
# Elections Canada October 21, 2019 Federal Election Results
# https://enr.elections.ca/National.aspx?lang=e
# sourced 2019-11-06
CDN_elec_2019 <- tibble(party = c("Liberal", "Conservative", "Bloc Québécois", "New Democratic", "Green", "Independent"),
                        seats = c(157, 121, 32, 24, 3, 1),
                        votes = c(5915950, 6155662, 1376135, 2849214, 1162361, 75836))
# hahaha! It's easier to make a tidy tibble and untidy it than make a messy one to start with
CDN_elec_2019 <- CDN_elec_2019 %>%
  pivot_longer(-party, names_to = "category", values_to = "number")
CDN_elec_2019
```

--

It violiates Principles #1 & #2--there are two variables (seats and votes) combined into one column, and there are two rows (seats and rows) for each observation (in this case, party)

_Sometimes untidy data can be too long!_

---

```{r}
CDN_elec_2019 %>%
  pivot_wider(names_from = category, values_from = number)
```

