---
title: "Strings"
subtitle: "hands-on examples, with answers"
output: html_document
---

<!-- 
This file by Martin Monkman is licensed under a Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). 

Some content is drawn from 

A. _R for Data Science_ by Hadley Wickham and Garrett Grolemund
-- (https://r4ds.had.co.nz/) -- which is licensed under the Creative Commons
Attribution-NonCommercial-NoDerivs 3.0 (CC BY-NC-ND 3.0 US) 


-->

```{r setup}
library(tidyverse)
library(stringr)
```



## Objectives

* Understand the basics of regular expressions (regexps)

* Understand basic functions in {stringr} for working with functions

* Demonstrate ability to use those functions


## Strings

Characters, numbers, etc

```{r}

string1 <- "This is my 1st string!"

string1

```

## Special characters

**quotes**

Single and double quotes need to be "escaped" with a `\`

```{r}

double_quote <- "\"" # or '"'
single_quote <- '\'' # or "'"

double_quote
single_quote

```


* to see a representation of the string as it will print, use the function `writeLines()`

```{r}

writeLines(double_quote)

```



```{r}

string2 <- 'The 2nd string has a "quote" so it is inside single quotes'

string2

writeLines(string2)

```


**other special characters**

These also need to be escaped:

| character | what it is |
| ---- | ---- |
| "\\" | backslash |
| "\n" | new line (line break) |
| "\t" | tab |
| "\u..." | unicode characters* |


* https://en.wikipedia.org/wiki/List_of_Unicode_characters

See the help function for `?'"'`

```{r}
interrobang <- "\u2048"
interrobang

```


To make a shruggie, you need to escape the backslash

```{r}
shruggie <- glue::glue("¯\\_(ツ)_/¯")
shruggie



shruggie <- glue::glue("¯\\", "_(ツ)_", "/¯")
shruggie

```





## Basic functions in {stringr}
 

![stringr hex](..\img\stringr_300.png)


```{r string_length}

x <- c("Sly", "Billie", "Thelonious", "Maroon", "Antonio", "Led")
x
str_length(x) 

```


use `str_c` to collapse list into one string

```{r str_c}

str_c(x, collapse = ", ")

```


---

## Combining strings

Use `str_c` to join two character vectors, separated by a space


```{r str_c_2}


y <- c("Stone", "Ellish", "Monk", "5", "Vivaldi", "Zeppelin")

str_c(x, y, sep = " ")

```

## Your turn 1.1

Now join `x` to `y`, separated by an apostrophe and a space

```{r your_turn_1.1}

#solution
str_c(y, x, sep = ", ")


```

---

## Pattern matching


```{r str_count}

str_count(x, "[aeiou]")
str_detect(x, "[aeiou]")

```


Find chunks of text by their location: `str_sub(x, start, end)`


```{r str_sub}

str_sub(x, 1, 2)  


```


`str_locate()` finds the first position of the pattern:

```{r}

str_locate(x, "([a])")

```




---

## Splitting strings

https://stringr.tidyverse.org/reference/str_split.html

function: `str_split()`


Back to the various ways dates are represented: if it's a character string with the month and year.

"Jan 2019"

```{r}

our_date <- "Jan 2019"


lubridate::ymd(our_date)


```

So that doesn't work.

We can split the string into two parts using `str_split()`, where we specify the space as the splitting element:

```{r}

str_split(our_date, " ")

```


```{r}

four_dates <- tribble(~ref_date, "Jan 2018", "Dec 2019", "Feb 2020", "Mar 2112")

four_dates <- four_dates %>% 
  mutate(value = 1:4)

four_dates

```

Inside a tibble, we use `separate()` from the {tidyr} package:

* https://tidyr.tidyverse.org/reference/separate.html

```{r}

four_dates2 <- four_dates %>% 
  separate(ref_date, into = c("ref_mon", "ref_year"), sep = " ")

four_dates2

```

https://stackoverflow.com/questions/6549239/convert-months-mmm-to-numeric



---

## REFERENCE

["Strings" in _R for Data Science_](https://r4ds.had.co.nz/strings.html) by Hadley Wickham and Garrett Grolemund

[{stringr}](https://stringr.tidyverse.org/)

[regex101](https://regex101.com/)



