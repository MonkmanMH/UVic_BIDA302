<!-- 
This file by Martin Monkman 
is licensed under a Creative Commons Attribution 4.0 International License
https://creativecommons.org/licenses/by/4.0/  

-->

```{r echo = FALSE}
library(knitr)
opts_chunk$set(message = FALSE, warning = FALSE, cache = TRUE)
options(width = 100, dplyr.width = 100)
```

# Assignment 2 - data wrangling & import {#assignment1}


Package load:
```{r packages}
library(tidyverse) # functions using {tidyr}, {dplyr}, and {readr}
library(readxl)    # to read Excel files

```

## YOUR NAME HERE



## Introduction

For this homework assignment, please write your answer for each question after the question text but before the line break before the next one.

In some cases, you will have to insert R code chunks, and run them to ensure that you've got the right result.

Use all of the R Markdown formatting you want! Bullets, bold text, etc. is welcome. And don't forget to consider changes to the YAML.

Once you have finished your assignment, create an HTML document by "knitting" the document using either the "Preview" or "Knit" button in the top left of the script window frame


## Questions


### 1. Religion and income data (USA)
(2 marks)

The table `relig_income` is in {tidyr}.

a. Load this table, and take a look at it. What tidy principle(s) does this table violate? 


```{r}
head(tidyr::relig_income)
```


b. Using the functions in {tidyr}, arrange this table in such a way that it is no longer untidy.



### 2. Importing data: csv
(5 marks)

**NOTE:** Variable names with spaces and special symbols are a challenge to work with. They require that you put the name inside a pair of back-ticks. For example, in the dataset below, a variable called `Court Region` _must_ be inside the back-ticks. 

Comma delimited files are one of the most common formats used for flat files. The tidyverse has a package, {readr}, which will automatically load with the function `library(tidyverse)`.

The reference page for {readr} is here: https://readr.tidyverse.org/index.html

a. Read in the file "cy-concluded-cases-5-yr-regional-report-dashboard-2014-to-2018.csv", which has the number of concluded court cases in B.C. by a variety of dimensions.^[Data source: British Columbia Data Catalogue, [Courts - Concluded Court Cases - 5 Yr Location Report - Dashboard - 2015 to 2019](https://catalogue.data.gov.bc.ca/dataset/courts-concluded-court-cases-5-yr-location-report-dashboard-2015-to-2019). Licensed under Open Government Licence - British Columbia.] 

Assign the contents of the file to a named object (remember, name things in a descriptive way!)



b. Read the file again, but specify that the region code should be a character.


c. Now you've read it in, use your data manipulation skills to find out how many cases were completed in each court region in 2018. Sort the table so the busiest regions are at the top.


d. Create a pivot table showing the total number of cases completed in each region during 2018, with the region as the rows and the court class as the columns. 



### 3. Importing data: Excel
(5 marks)

Use the {readxl} package to read in the file "regional_district_monthly_2019_mod.xlsx".^[Data source: British Columbia Data Catalogue, [Property Transfer Tax Data 2019](https://catalogue.data.gov.bc.ca/dataset/property-transfer-tax-data-2019). The original file has been modified: a) filtered for the Capital Regional District (CRD) and
b) the resulting table is transposed, so the rows now become the columns.
Licensed under Open Government Licence - British Columbia.]  

This data is published by the Ministry of Finance, and shows a variety of statistics associated with the Property Transfer Tax.

The reference page for {readxl} is here: https://readxl.tidyverse.org/

a. What are the names of the sheets in this file?


b. Read in the contents of the sheet with the shortest name.


c. What issues are there with the rows? What is the header row, and in what row does the data begin? How does this structure impact how the values in the columns are being represented? 

d. Change the options for your read function to address the issues you identified in 3.c


e. Use your data manipulation skills to calculate the number of residential property transfers where there was foreign involvement. (There are many variables; the one you're looking for is `FOREIGN INVOLVEMENT TRANSACTIONS - RESIDENTIAL (count)`). **Note:** Depending on what you did in 3.d, you may need to go back and read the data in again, adding more options.


-30-