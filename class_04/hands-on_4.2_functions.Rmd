---
title: "Functions"
subtitle: "hands-on examples, with answers"
output: html_document
---

<!-- 
This file by Martin Monkman is licensed under a Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). 

Some content is drawn from 

A. _R for Data Science_ by Hadley Wickham and Garrett Grolemund
-- (https://r4ds.had.co.nz/) -- which is licensed under the Creative Commons
Attribution-NonCommercial-NoDerivs 3.0 (CC BY-NC-ND 3.0 US) 

B. _Hands-On Programming with R_ by Garrett Grolemund
-- (https://rstudio-education.github.io/hopr/index.html) -- which is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 4.0
(CC BY-NC-ND 4.0 US) 

-->

```{r setup}
library(tidyverse)
library(glue)
```



## Objectives

* Understand and describe when and why a function is of value

* Understand the components of a function



![what's your function?](../img/shr_function.jpg)


Functions are an important part of programming in R. You have already used many functions ... now it's time to write your own.

Functions have particular value in making your code DRY (don't repeat yourself). If you need to do the same thing over and over again (whether in this script, or next month / quarter), you can either copy-and-paste with some find-and-replace, or take the time to write a generalized function. 

With a function, there's fewer opportunities for error (say, you miss a replacement) EXPAND THIS


There are three parts to any function:

* function name  
* inputs, which are called "arguments"  
* code statement(s) that do something with/to the argument(s)  

The code looks like this:

```{r evaluate = FALSE}
my.function.name <- function(my_argument_1, my_argument_2, ...) {
  code_statement
}
```

## 1. A simple example

(from ["Writing your own Functions" in _Hands-on Programming with R_](https://rstudio-education.github.io/hopr/basics.html#write-functions), by Garrett Grolemund)


Let's say you want to simulate rolling 2 six-sided dice. Here's some code that does that:

```{r}
# define the possible outcomes
die <- 1:6
# a random pair of numbers from the `die` object
dice <- sample(die, size = 2, replace = TRUE)
# then add them up
sum(dice)

```


To do this more than once, you would need to write the last two lines of code in again and again:

```{r}

dice <- sample(die, size = 2, replace = TRUE)
sum(dice)

dice <- sample(die, size = 2, replace = TRUE)
sum(dice)

dice <- sample(die, size = 2, replace = TRUE)
sum(dice)


```


_Or_ you could write a function.

In this case, our code_statement is the three lines of code:


```{r}

roll <- function() {
  die <- 1:6
  dice <- sample(die, size = 2, replace = TRUE)
  sum(dice)
}

```


Note that when we run this chunk, the function gets stored in our environment, and appears under Functions.

To run the function we just need the following:

```{r}

roll()

```


And it's very powerful in a tibble:

```{r}
# make a tibble with one column called `roll_num` that is the numbers from 1 to 10
dice_roll <- tibble(roll_num = 1:10)
dice_roll


row_num2 <- function(df){
  df %>%
   mutate(another_row_num = roll_num + 1)
}


calc_roll <- function(df){
  df %>%
   mutate(roll_total = roll())
}



```


Now, call the `roll()` function to generate a new column called `roll_total`

```{r}

row_num2(dice_roll)

calc_roll(dice_roll)

```










If you wanted to say hello to three people--John, Christy, and Gordon (the current premier of British Columbia, and his two predecessors). You could do this:

```{r}
print(glue("Hello, John"))
print(glue("Hello, Christy"))
print(glue("Hello, Gordon"))

```

Or you could write a function.

Note that in the code above, the only thing that changes is the name.

Our function, `hello()` would look like this:

```{r}

hello <- function(the_name) {
  glue("Hello, ", the_name)
}

```


Note that when we run this chunk, the function gets stored in our environment, and appears under Functions.

To run the function we just need the following:

```{r}

hello("Martin")

```


And we can pass the function into a tibble:

```{r}

premiers <- tibble(premier = c("John", "Christy", "Gordon"),
                   start_year = c(2017, 2011, 2001))

premiers

```


```{r}

premiers %>%
  mutate(greeting = hello(premier))

```



### REFERENCE

["Functions" in _R for Data Science_](https://r4ds.had.co.nz/functions.html) by Hadley Wickham and Garrett Grolemund

["Writing your own Functions" in _Hands-on Programming with R_](https://rstudio-education.github.io/hopr/basics.html#write-functions), by Garrett Grolemund


["Functions", from _Introduction to the R Language_](https://www.stat.berkeley.edu/~statcur/Workshop2/Presentations/functions.pdf), Berkley, Biostatistics 140.776


["Creating Functions", from _Programming with R_](https://swcarpentry.github.io/r-novice-inflammation/02-func-R/), Software Carpentry








