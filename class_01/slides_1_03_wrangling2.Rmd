---
title: "Data wrangling"
subtitle: "Part 2: introducing {tidyr}"
author: "BIDA302"
date: "2019/11/02"
output:
  xaringan::moon_reader:
    css: ["default", "css_files/eigengrau.css", "css_files/eigengrau-fonts.css"]    
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false

# Martin Monkman
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

library(tidyverse)
```

class: inverse

# Data wrangling

Reshaping



---

# {tidyr} -

![tidyr hex](../img/tidyr_400.png)

The [{tidyr} site](https://tidyr.tidyverse.org/)


---

A pivot table crosstab (1/2)


```{r}

mpg <- mpg

class_by_cyl <- mpg %>%
  group_by(class, cyl) %>%
  summarise(mean = mean(displ)) %>%
  arrange(desc(mean))

class_by_cyl

```


---

A pivot table crosstab (2/2)

using `pivot_wider()`

```{r}
class_by_cyl_pivot <- class_by_cyl %>%
  pivot_wider(names_from = cyl, values_from = mean)

class_by_cyl_pivot <- as.data.frame(class_by_cyl_pivot)

class_by_cyl_pivot
```

---

# and back to longer...

```{r}
class_by_cyl_pivot %>%
  pivot_longer(-class, names_to = "cyl", values_to = "mean")

```


---
Note that spread() (and gather(), it's complement) are the older {tidyr} functions that do the same thing

```{r}

mpg <- mpg

class_by_cyl <- mpg %>%
  group_by(class, cyl) %>%
  summarise(mean = mean(displ)) %>%
  arrange(desc(mean))

class_by_cyl

```


---

A pivot table crosstab (2/2)


```{r}
class_by_cyl_pivot <- class_by_cyl %>%
  spread(cyl, value = mean, drop = FALSE)

class_by_cyl_pivot <- as.data.frame(class_by_cyl_pivot)

class_by_cyl_pivot
```



